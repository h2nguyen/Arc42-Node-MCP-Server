{
  "id": "snapshot_1770929273055_4factrjz5",
  "approvalId": "approval_1770929273048_148xo1k07",
  "approvalTitle": "Tasks: Multi-Language Template Support",
  "version": 1,
  "timestamp": "2026-02-12T20:47:53.055Z",
  "trigger": "initial",
  "status": "pending",
  "content": "# Tasks Document: Multi-Language Template Support\n\n## Phase 1: Core Language Infrastructure\n\n- [ ] 1. Create LanguageStrategy interface\n  - File: `src/templates/locales/language-strategy.ts`\n  - Define the core interface that all language implementations must follow\n  - Include methods: getSectionTitle, getSectionDescription, getTemplate, getWorkflowGuide, getReadmeContent\n  - Export language-related type definitions\n  - Purpose: Establish the Strategy Pattern contract for language implementations\n  - _Leverage: src/types.ts (Arc42Section type)_\n  - _Requirements: Non-functional: Strategy Pattern_\n  - _Prompt: Implement the task for spec multi-language-templates, first run spec-workflow-guide to get the workflow guide then implement the task:\n    Role: TypeScript Developer specializing in design patterns and interfaces\n    Task: Create the LanguageStrategy interface that defines the contract for all language implementations, including code/name/nativeName properties and methods for section titles, descriptions, templates, workflow guide, and readme content\n    Restrictions: Do not implement concrete classes yet, only the interface. Follow kebab-case file naming. Use PascalCase for interface name. Export all types needed by strategy implementations\n    _Leverage: src/types.ts for Arc42Section type\n    _Requirements: Non-functional Design Patterns - Strategy Pattern\n    Success: Interface compiles without errors, includes all 5 required methods, properly typed with Arc42Section parameter\n    After completing implementation, mark this task [-] as in-progress in tasks.md, then log implementation with log-implementation tool, then mark [x] as complete_\n\n- [ ] 2. Create LanguageRegistry class\n  - File: `src/templates/locales/language-registry.ts`\n  - Implement registry for storing and retrieving language strategies\n  - Methods: register, get, getOrThrow, getAll, isSupported, getAvailableCodes, getDefault\n  - Use Map for O(1) lookup by normalized language code\n  - Purpose: Implement Registry Pattern as single source of truth for available languages\n  - _Leverage: src/templates/locales/language-strategy.ts_\n  - _Requirements: Non-functional: Registry Pattern_\n  - _Prompt: Implement the task for spec multi-language-templates, first run spec-workflow-guide to get the workflow guide then implement the task:\n    Role: TypeScript Developer specializing in design patterns and data structures\n    Task: Create LanguageRegistry class that maintains a Map of language strategies, with methods for registration, lookup (case-insensitive), validation, and enumeration\n    Restrictions: Normalize all codes to uppercase for storage and lookup. getDefault should return English. getOrThrow should throw descriptive error with available codes\n    _Leverage: src/templates/locales/language-strategy.ts\n    _Requirements: Non-functional Design Patterns - Registry Pattern\n    Success: Registry correctly stores and retrieves strategies, case-insensitive lookup works, getAvailableCodes returns all 11 language codes\n    After completing implementation, mark this task [-] as in-progress in tasks.md, then log implementation with log-implementation tool, then mark [x] as complete_\n\n- [ ] 3. Create LanguageFactory class\n  - File: `src/templates/locales/language-factory.ts`\n  - Implement factory for creating language strategy instances\n  - Methods: create, createWithFallback, normalizeCode\n  - Handle case normalization and fallback to English for unknown codes\n  - Purpose: Implement Factory Pattern for centralized object creation\n  - _Leverage: src/templates/locales/language-registry.ts_\n  - _Requirements: Non-functional: Factory Pattern_\n  - _Prompt: Implement the task for spec multi-language-templates, first run spec-workflow-guide to get the workflow guide then implement the task:\n    Role: TypeScript Developer specializing in creational design patterns\n    Task: Create LanguageFactory class that creates language strategy instances from the registry, with code normalization and fallback logic\n    Restrictions: create() should throw for unknown codes, createWithFallback() should return English with warning for unknown codes. normalizeCode should handle mixed case and trim whitespace\n    _Leverage: src/templates/locales/language-registry.ts\n    _Requirements: Non-functional Design Patterns - Factory Pattern\n    Success: Factory creates correct strategy for each language code, fallback returns English, normalization handles \"de\", \"DE\", \"De\" identically\n    After completing implementation, mark this task [-] as in-progress in tasks.md, then log implementation with log-implementation tool, then mark [x] as complete_\n\n- [ ] 4. Create LocalizedTemplateProvider class\n  - File: `src/templates/locales/template-provider.ts`\n  - Implement TemplateProvider interface for language-aware template access\n  - Methods: getTemplate, getSectionMetadata, getAvailableLanguages\n  - Integrate with config.yaml for default language reading\n  - Purpose: Implement Provider Pattern for abstracted template retrieval\n  - _Leverage: src/templates/locales/language-factory.ts, yaml library_\n  - _Requirements: Non-functional: Provider Pattern, Requirement 2, 3_\n  - _Prompt: Implement the task for spec multi-language-templates, first run spec-workflow-guide to get the workflow guide then implement the task:\n    Role: TypeScript Developer specializing in provider patterns and configuration\n    Task: Create LocalizedTemplateProvider class that provides language-aware template access, reading default language from config.yaml and allowing parameter override\n    Restrictions: Parameter should override config setting. If neither provided, default to English. Handle missing config.yaml gracefully\n    _Leverage: src/templates/locales/language-factory.ts, yaml library for config reading\n    _Requirements: Requirement 2 (Language-Aware Template Generation), Requirement 3 (Language Configuration Persistence)\n    Success: Provider returns templates in correct language, config override works, available languages list returns all 11\n    After completing implementation, mark this task [-] as in-progress in tasks.md, then log implementation with log-implementation tool, then mark [x] as complete_\n\n- [ ] 5. Create locales barrel export\n  - File: `src/templates/locales/index.ts`\n  - Export all locales components: LanguageStrategy, LanguageRegistry, LanguageFactory, LocalizedTemplateProvider\n  - Create and export singleton instances: registry, factory, provider\n  - Purpose: Provide clean import interface for locales module\n  - _Leverage: All files from tasks 1-4_\n  - _Requirements: structure.md: Barrel exports_\n  - _Prompt: Implement the task for spec multi-language-templates, first run spec-workflow-guide to get the workflow guide then implement the task:\n    Role: TypeScript Developer specializing in module organization\n    Task: Create barrel export file that exports all types, classes, and singleton instances from the locales module\n    Restrictions: Follow existing barrel export patterns in the project. Export singleton instances for registry, factory, and provider\n    _Leverage: src/templates/locales/*.ts\n    _Requirements: structure.md conventions for barrel exports\n    Success: All types and classes importable from src/templates/locales, singleton instances properly initialized\n    After completing implementation, mark this task [-] as in-progress in tasks.md, then log implementation with log-implementation tool, then mark [x] as complete_\n\n## Phase 2: English Strategy (Refactor Existing)\n\n- [ ] 6. Create English language strategy\n  - Files: `src/templates/locales/en/index.ts`, `src/templates/locales/en/sections.ts`, `src/templates/locales/en/templates.ts`\n  - Refactor existing English templates from src/templates/index.ts into strategy implementation\n  - Implement LanguageStrategy interface for English\n  - Purpose: Create reference implementation and preserve existing functionality\n  - _Leverage: src/templates/index.ts (existing templates), src/templates/locales/language-strategy.ts_\n  - _Requirements: Requirement 1 (default to English)_\n  - _Prompt: Implement the task for spec multi-language-templates, first run spec-workflow-guide to get the workflow guide then implement the task:\n    Role: TypeScript Developer specializing in refactoring and migration\n    Task: Create English language strategy by refactoring existing templates from src/templates/index.ts into the new locales structure, implementing the LanguageStrategy interface\n    Restrictions: Must preserve ALL existing template content exactly. Do not modify existing templates - copy and restructure only. English is the default language\n    _Leverage: src/templates/index.ts (existing templates to refactor)\n    _Requirements: Requirement 1 (EN is default)\n    Success: English strategy passes all existing template tests, content identical to current templates, properly implements interface\n    After completing implementation, mark this task [-] as in-progress in tasks.md, then log implementation with log-implementation tool, then mark [x] as complete_\n\n- [ ] 7. Register English strategy and update templates/index.ts\n  - Files: `src/templates/index.ts` (modify), `src/templates/locales/index.ts` (modify)\n  - Register English strategy in the LanguageRegistry\n  - Update templates/index.ts to re-export from locales module\n  - Purpose: Integrate English strategy with registry and maintain backward compatibility\n  - _Leverage: src/templates/locales/en/index.ts, src/templates/locales/language-registry.ts_\n  - _Requirements: Backward compatibility_\n  - _Prompt: Implement the task for spec multi-language-templates, first run spec-workflow-guide to get the workflow guide then implement the task:\n    Role: TypeScript Developer specializing in API design and backward compatibility\n    Task: Register English strategy in the registry and update templates/index.ts to use the new locales system while maintaining backward compatibility for existing imports\n    Restrictions: Existing imports from src/templates must continue to work. Do not break any existing functionality\n    _Leverage: src/templates/locales/en/index.ts, src/templates/locales/index.ts\n    _Requirements: Backward compatibility with existing code\n    Success: All existing tests pass without modification, English templates accessible via both old and new imports\n    After completing implementation, mark this task [-] as in-progress in tasks.md, then log implementation with log-implementation tool, then mark [x] as complete_\n\n## Phase 3: Additional Language Strategies (10 languages)\n\n- [ ] 8. Create German (DE) language strategy\n  - Files: `src/templates/locales/de/index.ts`, `src/templates/locales/de/sections.ts`, `src/templates/locales/de/templates.ts`\n  - Translate section titles, descriptions, and template content to German\n  - Register in LanguageRegistry\n  - Purpose: Add German language support\n  - _Leverage: vendor/arc42-template/DE/, src/templates/locales/en/ (as structure reference)_\n  - _Requirements: Requirement 4 (localized section titles)_\n  - _Prompt: Implement the task for spec multi-language-templates, first run spec-workflow-guide to get the workflow guide then implement the task:\n    Role: TypeScript Developer with German language proficiency\n    Task: Create German language strategy using translations from vendor/arc42-template/DE/, following the same structure as English strategy\n    Restrictions: Use official arc42 German translations from vendor folder. Maintain same structure as English implementation\n    _Leverage: vendor/arc42-template/DE/ for German translations, src/templates/locales/en/ for structure\n    _Requirements: Requirement 4 (Translation of Section Titles and Metadata)\n    Success: German strategy implements interface, all section titles/descriptions in German, registered in registry\n    After completing implementation, mark this task [-] as in-progress in tasks.md, then log implementation with log-implementation tool, then mark [x] as complete_\n\n- [ ] 9. Create remaining 9 language strategies\n  - Files: `src/templates/locales/{cz,es,fr,it,nl,pt,ru,ukr,zh}/` (3 files each)\n  - Create strategies for: Czech, Spanish, French, Italian, Dutch, Portuguese, Russian, Ukrainian, Chinese\n  - Register all in LanguageRegistry\n  - Purpose: Complete all 11 language implementations\n  - _Leverage: vendor/arc42-template/{CZ,ES,FR,IT,NL,PT,RU,UKR,ZH}/, src/templates/locales/en/_\n  - _Requirements: Supported Languages table in requirements.md_\n  - _Prompt: Implement the task for spec multi-language-templates, first run spec-workflow-guide to get the workflow guide then implement the task:\n    Role: TypeScript Developer with internationalization expertise\n    Task: Create language strategies for all remaining 9 languages (CZ, ES, FR, IT, NL, PT, RU, UKR, ZH) using translations from vendor/arc42-template folders\n    Restrictions: Use official arc42 translations from vendor folders. Each language follows same structure as English. Register all in registry\n    _Leverage: vendor/arc42-template/{lang}/ folders, src/templates/locales/en/ for structure\n    _Requirements: Supported Languages table - all 11 languages\n    Success: All 9 strategies implement interface correctly, registered in registry, getAvailableCodes returns all 11\n    After completing implementation, mark this task [-] as in-progress in tasks.md, then log implementation with log-implementation tool, then mark [x] as complete_\n\n## Phase 4: Tool Integration\n\n- [ ] 10. Extend arc42-init with language parameter\n  - File: `src/tools/arc42-init.ts` (modify)\n  - Add `language` parameter to tool schema\n  - Use LocalizedTemplateProvider for template generation\n  - Save language setting to config.yaml\n  - Purpose: Enable language selection during workspace initialization\n  - _Leverage: src/templates/locales/template-provider.ts, src/tools/arc42-init.ts_\n  - _Requirements: Requirement 1 (Language Selection for arc42-init)_\n  - _Prompt: Implement the task for spec multi-language-templates, first run spec-workflow-guide to get the workflow guide then implement the task:\n    Role: MCP Tool Developer with TypeScript expertise\n    Task: Extend arc42-init tool to accept optional language parameter, use LocalizedTemplateProvider for templates, and save language to config.yaml\n    Restrictions: Default to English if no language specified. Validate language code against supported list. Save language in config.yaml project section\n    _Leverage: src/templates/locales/template-provider.ts, existing arc42-init implementation\n    _Requirements: Requirement 1 (Language Selection for arc42-init)\n    Success: arc42-init accepts language parameter, creates templates in specified language, saves to config.yaml\n    After completing implementation, mark this task [-] as in-progress in tasks.md, then log implementation with log-implementation tool, then mark [x] as complete_\n\n- [ ] 11. Extend generate-template with language support\n  - File: `src/tools/generate-template.ts` (modify)\n  - Add optional `language` parameter to tool schema\n  - Read default language from config.yaml if not specified\n  - Use LocalizedTemplateProvider for template generation\n  - Purpose: Enable language-aware template generation\n  - _Leverage: src/templates/locales/template-provider.ts, src/tools/generate-template.ts_\n  - _Requirements: Requirement 2 (Language-Aware Template Generation)_\n  - _Prompt: Implement the task for spec multi-language-templates, first run spec-workflow-guide to get the workflow guide then implement the task:\n    Role: MCP Tool Developer with TypeScript expertise\n    Task: Extend generate-template tool to support language parameter and read default from config.yaml\n    Restrictions: Parameter overrides config. If neither provided, use English default. Maintain existing tool behavior for English\n    _Leverage: src/templates/locales/template-provider.ts, existing generate-template implementation\n    _Requirements: Requirement 2 (Language-Aware Template Generation)\n    Success: generate-template returns templates in correct language, respects config.yaml setting, parameter override works\n    After completing implementation, mark this task [-] as in-progress in tasks.md, then log implementation with log-implementation tool, then mark [x] as complete_\n\n- [ ] 12. Extend arc42-status with language display\n  - File: `src/tools/arc42-status.ts` (modify)\n  - Read language setting from config.yaml\n  - Include language in status response\n  - Show \"EN (default)\" when not configured\n  - Purpose: Display configured language in project status\n  - _Leverage: src/tools/arc42-status.ts, yaml library_\n  - _Requirements: Requirement 3 (Language Configuration Persistence)_\n  - _Prompt: Implement the task for spec multi-language-templates, first run spec-workflow-guide to get the workflow guide then implement the task:\n    Role: MCP Tool Developer with TypeScript expertise\n    Task: Extend arc42-status tool to read and display the configured language from config.yaml\n    Restrictions: Show \"EN (default)\" if language not configured. Display both language code and name (e.g., \"DE (German)\")\n    _Leverage: existing arc42-status implementation, yaml library\n    _Requirements: Requirement 3 (arc42-status SHALL display the project's configured language)\n    Success: arc42-status includes language in response, shows default when not set, displays human-readable name\n    After completing implementation, mark this task [-] as in-progress in tasks.md, then log implementation with log-implementation tool, then mark [x] as complete_\n\n- [ ] 13. Update arc42-workflow-guide with language info\n  - File: `src/tools/arc42-workflow-guide.ts` (modify)\n  - Include list of available languages in workflow guide response\n  - Document language parameter usage\n  - Purpose: Make available languages discoverable\n  - _Leverage: src/templates/locales/language-registry.ts, src/tools/arc42-workflow-guide.ts_\n  - _Requirements: Non-functional: Usability (languages discoverable)_\n  - _Prompt: Implement the task for spec multi-language-templates, first run spec-workflow-guide to get the workflow guide then implement the task:\n    Role: MCP Tool Developer with documentation expertise\n    Task: Update arc42-workflow-guide to include available languages and document how to use language parameter\n    Restrictions: List all 11 languages with codes and names. Document usage in arc42-init and generate-template sections\n    _Leverage: src/templates/locales/language-registry.ts for language list\n    _Requirements: Non-functional Usability - languages discoverable via workflow guide\n    Success: Workflow guide includes language section with all 11 languages listed, usage documented\n    After completing implementation, mark this task [-] as in-progress in tasks.md, then log implementation with log-implementation tool, then mark [x] as complete_\n\n- [ ] 14. Register updated tools in server.ts\n  - File: `src/server.ts` (modify)\n  - Update tool registrations with new `language` parameter schemas\n  - Add Zod validation for language codes\n  - Purpose: Expose language parameters in MCP tool definitions\n  - _Leverage: src/server.ts, zod_\n  - _Requirements: Requirement 1 acceptance criteria 6 (error with valid codes)_\n  - _Prompt: Implement the task for spec multi-language-templates, first run spec-workflow-guide to get the workflow guide then implement the task:\n    Role: MCP Server Developer with Zod validation expertise\n    Task: Update server.ts tool registrations to include language parameter with Zod validation\n    Restrictions: Language parameter should be optional. Validation should be case-insensitive. Error message should list valid codes\n    _Leverage: src/server.ts existing tool registrations, zod for validation\n    _Requirements: Requirement 1 AC 6 (error listing available languages)\n    Success: All tool schemas include language parameter, Zod validation works, error messages helpful\n    After completing implementation, mark this task [-] as in-progress in tasks.md, then log implementation with log-implementation tool, then mark [x] as complete_\n\n## Phase 5: Testing\n\n- [ ] 15. Add unit tests for language infrastructure\n  - Files: `src/__tests__/templates/locales/language-registry.test.ts`, `language-factory.test.ts`, `template-provider.test.ts`\n  - Test registry: registration, lookup, validation\n  - Test factory: normalization, fallback\n  - Test provider: template retrieval, config integration\n  - Purpose: Ensure core language infrastructure works correctly\n  - _Leverage: src/__tests__/fixtures/test-helpers.ts, vitest_\n  - _Requirements: Testing Strategy in design.md_\n  - _Prompt: Implement the task for spec multi-language-templates, first run spec-workflow-guide to get the workflow guide then implement the task:\n    Role: QA Engineer with Vitest expertise\n    Task: Create comprehensive unit tests for LanguageRegistry, LanguageFactory, and LocalizedTemplateProvider\n    Restrictions: Follow existing test patterns. Test both success and failure cases. Use mock strategies for isolated testing\n    _Leverage: src/__tests__/fixtures/test-helpers.ts, existing test patterns\n    _Requirements: Testing Strategy in design.md - Unit Testing section\n    Success: All core classes have comprehensive tests, edge cases covered, tests pass independently\n    After completing implementation, mark this task [-] as in-progress in tasks.md, then log implementation with log-implementation tool, then mark [x] as complete_\n\n- [ ] 16. Add unit tests for language strategies\n  - File: `src/__tests__/templates/locales/strategies.test.ts`\n  - Test each of the 11 language strategies\n  - Verify all sections have titles, descriptions, templates\n  - Verify template content is valid markdown\n  - Purpose: Ensure all language implementations are complete and correct\n  - _Leverage: src/__tests__/fixtures/test-helpers.ts, vitest_\n  - _Requirements: Testing Strategy in design.md_\n  - _Prompt: Implement the task for spec multi-language-templates, first run spec-workflow-guide to get the workflow guide then implement the task:\n    Role: QA Engineer with internationalization testing expertise\n    Task: Create tests for all 11 language strategies verifying completeness and correctness\n    Restrictions: Test all 12 sections for each language. Verify non-empty content. Check markdown validity\n    _Leverage: src/__tests__/fixtures/test-helpers.ts\n    _Requirements: Testing Strategy - test each LanguageStrategy\n    Success: All 11 strategies tested for all 12 sections, no empty content, all tests pass\n    After completing implementation, mark this task [-] as in-progress in tasks.md, then log implementation with log-implementation tool, then mark [x] as complete_\n\n- [ ] 17. Extend tool tests with language scenarios\n  - Files: `src/__tests__/tools/arc42-init.test.ts`, `generate-template.test.ts`, `arc42-status.test.ts` (extend existing)\n  - Add tests for language parameter handling\n  - Test config.yaml language persistence\n  - Test fallback behavior\n  - Purpose: Ensure tools work correctly with language support\n  - _Leverage: Existing tool tests, vitest_\n  - _Requirements: Testing Strategy in design.md - Integration Testing_\n  - _Prompt: Implement the task for spec multi-language-templates, first run spec-workflow-guide to get the workflow guide then implement the task:\n    Role: QA Engineer with MCP tool testing expertise\n    Task: Extend existing tool tests with language-specific scenarios\n    Restrictions: Do not remove existing tests. Add language scenarios as additional test cases. Test error handling for invalid codes\n    _Leverage: Existing tool test files\n    _Requirements: Testing Strategy - Integration Testing section\n    Success: All new language scenarios tested, existing tests still pass, error handling verified\n    After completing implementation, mark this task [-] as in-progress in tasks.md, then log implementation with log-implementation tool, then mark [x] as complete_\n\n## Phase 6: Documentation\n\n- [ ] 18. Update README.md with language documentation\n  - File: `README.md` (modify)\n  - Document language parameter in tool descriptions\n  - Add examples for different languages\n  - Update \"Available Tools\" section\n  - Purpose: Document multi-language feature for users\n  - _Leverage: README.md_\n  - _Requirements: Usability_\n  - _Prompt: Implement the task for spec multi-language-templates, first run spec-workflow-guide to get the workflow guide then implement the task:\n    Role: Technical Writer with developer documentation expertise\n    Task: Update README.md to document the new multi-language feature with examples\n    Restrictions: Follow existing README style. Include examples for at least 3 languages. Update all affected tool sections\n    _Leverage: Existing README.md structure\n    _Requirements: Non-functional Usability - documentation\n    Success: README documents all 11 supported languages, includes usage examples, tool sections updated\n    After completing implementation, mark this task [-] as in-progress in tasks.md, then log implementation with log-implementation tool, then mark [x] as complete_\n\n- [ ] 19. Create CHANGELOG entry\n  - File: `CHANGELOG.md` (modify)\n  - Document multi-language template support feature\n  - List all supported languages\n  - Note any breaking changes (none expected)\n  - Purpose: Track feature for release notes\n  - _Leverage: CHANGELOG.md_\n  - _Requirements: Release documentation_\n  - _Prompt: Implement the task for spec multi-language-templates, first run spec-workflow-guide to get the workflow guide then implement the task:\n    Role: Technical Writer with release documentation expertise\n    Task: Add CHANGELOG entry for multi-language template support feature\n    Restrictions: Follow existing CHANGELOG format. Use semantic versioning guidelines. List all 11 languages\n    _Leverage: Existing CHANGELOG.md format\n    _Requirements: Release documentation\n    Success: CHANGELOG entry added with feature description, language list, and usage summary\n    After completing implementation, mark this task [-] as in-progress in tasks.md, then log implementation with log-implementation tool, then mark [x] as complete_\n",
  "fileStats": {
    "size": 26209,
    "lines": 330,
    "lastModified": "2026-02-12T20:47:41.534Z"
  },
  "comments": []
}